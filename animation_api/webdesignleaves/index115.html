<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      body {
        max-width: 580px;
        margin: 50px auto;
      }
      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }
      h1,
      h2 {
        margin: 3rem 0;
      }
      a {
        text-decoration: none;
        color: mediumslateblue;
      }
      ul {
        list-style: none;
        padding-left: 0.5rem;
        margin: 2rem 0.5rem;
        display: flex;
        justify-content: space-between;
      }
      ul.sub {
        justify-content: flex-start;
      }
      ul.sub li {
        margin-right: 1rem;
      }
      div {
        margin: 50px 0;
      }
      .relative {
        position: relative;
      }
      #scroll-to-top {
        position: fixed; /* 画面右下に固定配置 */
        right: 15px;
        bottom: 2rem;
        z-index: 100;
        font-size: 0.75rem;
        background-color: rgba(0, 0, 0, 0.35);
        width: 80px;
        height: 50px;
        clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
        color: #fff;
        line-height: 50px;
        text-align: center;
        transition: opacity 0.4s;
        opacity: 0.7;
        cursor: pointer;
      }
      #scroll-to-top:hover {
        opacity: 1;
      }
      .pt {
        margin-top: 2rem;
      }
      .pt a {
        background-color: mediumpurple;
        padding: 0.5rem 1rem;
        color: #fff;
      }
    </style>
  </head>
  <body>
    <h1>Smooth Scroll Sample</h1>
    <span style="margin-right: 10px">Select Easing: </span>
    <select name="easing">
      <option value="easeInCirc" selected>easeInCirc</option>
      <option value="easeInQuint">easeInQuint</option>
      <option value="easeOutQuint">easeOutQuint</option>
      <option value="easeInOutExpo">easeInOutExpo</option>
      <option value="easeInOutBack">easeInOutBack</option>
      <option value="easeOutBounce">easeOutBounce</option>
      <option value="easeLinear">easeLinear</option>
    </select>
    <ul>
      <li><a href="#chap1">Chapter I</a></li>
      <li><a href="#chap2">Chapter II</a></li>
      <li><a href="#chap3">Chapter III</a></li>
      <li><a href="#chap4">Chapter IV</a></li>
      <li><a href="#chap5">Chapter V</a></li>
    </ul>
    <div id="chap1" class="relative">
      <h2>Chapter I</h2>
      <p>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Numquam,
        ratione. Nihil ea, eum vel, porro cum quis illum consequatur alias odit
        deserunt. Iure inventore nostrum quis magni illum ea dicta.
      </p>
      <p>
        Illo eaque odio necessitatibus odit minus? Nihil accusamus modi maxime
        iusto, <a href="#fugiat">fugiat </a>sit eum ullam. Totam maxime aliquid
        molestiae, eius dolor nesciunt nemo similique voluptatibus consequatur
        sed commodi necessitatibus fuga!
      </p>
      <p>
        Magni ipsa veniam quae! Laboriosam est, ratione architecto facilis fugit
        perspiciatis fuga quod, earum id quibusdam nobis, voluptatibus commodi
        eaque cupiditate delectus eligendi velit minus aliquid rem, vero unde
        et!
      </p>
      <p>
        Similique, distinctio quis numquam maxime, at inventore mollitia eius
        rem vero debitis? Laborum inventore quaerat, aliquid magnam, aliquam,
        blanditiis at cumque nam nostrum, dicta eius
        <span id="officia" style="color: red">officia</span> architecto debitis
        laboriosam libero!
      </p>
      <p>
        Quos fuga vero architecto dolorem, minima iure atque quas odio quo?
        Repellat officia id neque fugit illo tenetur quas assumenda, molestias
        voluptatem mollitia sunt laboriosam odio animi aspernatur eius aliquid!
      </p>
      <ul class="sub">
        <li><a href="#chap2">Chapter II</a></li>
        <li><a href="#chap3">Chapter III</a></li>
        <li><a href="#chap4">Chapter IV</a></li>
        <li><a href="#chap5">Chapter V</a></li>
      </ul>
      <p class="pt"><a href="#">Page Top</a></p>
    </div>
    <div id="chap2">
      <h2>Chapter II</h2>
      <p>
        Laborum fuga culpa commodi fugiat optio officiis quibusdam dolore qui.
        Consequuntur quasi consequatur optio eos mollitia autem! Sit
        repudiandae, expedita sint excepturi quae praesentium architecto quod
        omnis nesciunt. Error, ea.
      </p>
      <p>
        Doloremque et assumenda fugit vel laboriosam quis unde sit minima autem.
        Saepe dolorum, soluta dolorem quod numquam, incidunt aliquam debitis,
        sunt eos impedit iure omnis minus asperiores nam doloremque ut.
      </p>
      <p>
        Quaerat at, expedita dolorem consequuntur molestiae aperiam deleniti in
        alias fugiat dolores natus iure amet numquam delectus unde veniam
        placeat nihil laudantium facere earum, optio nemo voluptate, culpa
        quisquam. Blanditiis!
      </p>
      <p>
        Cupiditate, ipsum, voluptate. Amet nostrum a sint consequatur molestiae
        sed, tempore provident, neque soluta necessitatibus iusto aliquid
        accusantium perferendis. Quia molestiae nam illo quibusdam
        <span id="officia2" style="color: red">officia2</span> eligendi
        voluptates esse, saepe distinctio illum.
      </p>
      <p>
        Voluptatum cupiditate placeat quibusdam, ut enim ab facere iusto animi
        libero eveniet repudiandae harum commodi! Distinctio velit neque
        incidunt, aspernatur aliquam explicabo repellat quibusdam, laudantium
        quasi dolores, modi ut nihil.
      </p>
      <p>
        Minus voluptate, veniam nam ipsam dolores soluta blanditiis. Nihil, rem
        quis aut. Magni aliquam repudiandae iusto, saepe, voluptates excepturi
        molestiae consectetur deserunt facere perferendis totam, atque autem ex
        sit, in.
      </p>
      <ul class="sub">
        <li><a href="#chap1">Chapter I</a></li>
        <li><a href="#chap3">Chapter III</a></li>
        <li><a href="#chap4">Chapter IV</a></li>
        <li><a href="#chap5">Chapter V</a></li>
      </ul>
      <p class="pt"><a href="#">Page Top</a></p>
    </div>
    <div id="chap3" class="relative">
      <h2>Chapter III</h2>
      <p>
        Blanditiis dignissimos nostrum dolores maiores facere deserunt, quo.
        Deleniti ullam esse cupiditate dicta, repellat ipsam veritatis
        blanditiis voluptates praesentium error doloremque ea, aspernatur eius!
        Voluptatem maiores incidunt adipisci, animi voluptate.
      </p>
      <p>
        Iure reiciendis nostrum, consectetur asperiores vel officia? Placeat
        consequuntur accusamus nulla praesentium provident facilis cumque,
        deserunt vero, laboriosam dolore illo vitae officia minus reiciendis
        dolores! A <span id="fugiat" style="color: red">fugiat</span> laboriosam
        iusto perferendis.
      </p>
      <p>
        Repudiandae praesentium ex, illo est, eos excepturi rerum delectus,
        voluptatum in non officiis quibusdam numquam quaerat. Suscipit id nulla
        in, explicabo culpa cum dolore dolor, quas, delectus maxime cupiditate
        obcaecati.
      </p>
      <p>
        Et, fuga aliquid. Aperiam deleniti temporibus cumque consectetur
        veritatis, <a href="#officia">officia</a> tempora laborum voluptatum
        voluptas repudiandae perferendis, obcaecati delectus velit repellendus
        totam? Voluptas facere amet, tempora magnam praesentium veritatis aut
        ipsam.
      </p>
      <p>
        Iusto porro eius dolores, vero culpa enim repudiandae. Nesciunt
        excepturi eum quae harum iure facere, aut nam doloremque, soluta
        perspiciatis veritatis, reiciendis quis voluptatum. Consequatur aut
        impedit, libero quidem. Animi.
      </p>
      <p>
        Magnam fugit omnis quibusdam nisi. Asperiores omnis distinctio in
        aliquam sapiente vitae iste, dignissimos ab
        <a href="#officia2">officia2</a> voluptatum ut eaque, eius non magni
        exercitationem sunt numquam minima temporibus! Aut totam, natus.
      </p>
      <p>
        Minima ipsam ut, maxime illum totam illo quis nesciunt cumque voluptatem
        soluta vel inventore id placeat dicta deleniti, est nisi nulla quos
        nihil. Quis veritatis odit quo incidunt. Earum, fuga.
      </p>
      <ul class="sub">
        <li><a href="#chap1">Chapter I</a></li>
        <li><a href="#chap2">Chapter II</a></li>
        <li><a href="#chap4">Chapter IV</a></li>
        <li><a href="#chap5">Chapter V</a></li>
      </ul>
      <p class="pt"><a href="#">Page Top</a></p>
    </div>
    <div id="chap4">
      <h2>Chapter IV</h2>
      <p>
        Sapiente dicta ipsum eum ad consequatur minima atque, molestiae sint,
        iure cumque nihil, harum laborum velit recusandae culpa veniam ut
        voluptate totam commodi! Vero, iste velit aperiam vel illum repellendus.
      </p>
      <p>
        Quis soluta exercitationem sapiente nisi molestias temporibus iste
        repellat nesciunt fuga, ab accusamus incidunt officiis saepe culpa? Et
        omnis ad cumque numquam doloribus cum quod est molestiae, nam debitis
        dignissimos!
      </p>
      <p>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Officia magnam
        facilis rem ipsa fugit delectus deleniti. Itaque molestiae, perferendis
        reiciendis nihil commodi delectus ratione architecto rerum harum natus
        placeat eos!
      </p>
      <p>
        Voluptates dolore, consequuntur adipisci cumque architecto, ullam
        aliquam. Consectetur ratione dolores, non nisi ea distinctio doloremque
        quisquam quaerat qui. Iste, adipisci, libero. Eos voluptatum minima,
        debitis excepturi at dolor nisi.
      </p>
      <p>
        Est inventore adipisci magnam ad recusandae dolores cumque temporibus
        voluptatem harum ex, voluptate earum architecto aut, distinctio enim
        iure mollitia id repellat vel! Quisquam rerum ullam, corporis dicta
        tenetur omnis.
      </p>
      <p>
        Odit, ex! Autem porro numquam nesciunt perferendis ducimus molestiae
        optio possimus. Nihil consectetur id quam animi autem ut earum commodi
        rerum recusandae, cumque vitae quisquam incidunt hic, ipsum, deserunt
        quas.
      </p>
      <p>
        Quas, modi inventore perspiciatis quod, corporis ipsam ad harum at
        possimus architecto sunt optio deserunt a hic cumque enim ex nostrum
        fuga voluptatem commodi! Sed cumque, pariatur obcaecati harum officiis.
      </p>
      <ul class="sub">
        <li><a href="#chap1">Chapter I</a></li>
        <li><a href="#chap2">Chapter II</a></li>
        <li><a href="#chap3">Chapter III</a></li>
        <li><a href="#chap5">Chapter V</a></li>
      </ul>
      <p class="pt"><a href="#">Page Top</a></p>
    </div>
    <div id="chap5" class="relative">
      <h2>Chapter V</h2>
      <p>
        Nam quisquam, quia, distinctio quam aut praesentium repellat molestiae,
        commodi officiis dicta adipisci, quo! Neque magni nam alias, unde
        voluptatum incidunt maiores quae minima, odio et hic veritatis libero
        eveniet.
      </p>
      <p>
        Facere illum, autem. Qui facilis dolor minima aperiam tempore. Qui enim
        dolorem odio possimus, dignissimos libero expedita, perspiciatis,
        doloribus, architecto praesentium tenetur illo. Cum dolorum, ut, dicta
        dolor rerum ipsa!
      </p>
      <p>
        Accusamus eaque vero dicta quos, nemo corporis maxime quo expedita.
        Consequatur similique, debitis necessitatibus, rem sapiente esse
        excepturi dolor iste! Dolore, aliquid. Omnis saepe a aliquid, fugiat nam
        sunt dolor.
      </p>
      <p>
        Quidem velit, ullam quo natus quia, ad quod! Culpa a, ducimus sapiente
        sequi quidem vel accusamus! Voluptate non, dolor, similique dignissimos
        expedita reprehenderit dolorum iusto id repudiandae exercitationem
        commodi numquam.
      </p>
      <p>
        Deserunt repudiandae impedit dolorem assumenda voluptates, excepturi vel
        explicabo tempore ex doloremque nemo consequuntur voluptatum voluptas
        nesciunt commodi dolore maiores, repellendus nisi laboriosam
        exercitationem hic dolorum, accusamus aliquam veniam. Tenetur.
      </p>
      <ul class="sub">
        <li><a href="#chap1">Chapter I</a></li>
        <li><a href="#chap2">Chapter II</a></li>
        <li><a href="#chap3">Chapter III</a></li>
        <li><a href="#chap4">Chapter IV</a></li>
      </ul>
      <p class="pt"><a href="#">Page Top</a></p>
    </div>
    <div id="scroll-to-top">
      <p>Top</p>
    </div>

    <script>
      const easeLinear = (x) => {
        return x;
      };
      const easeInSine = (x) => {
        return 1 - Math.cos((x * Math.PI) / 2);
      };
      const easeOutSine = (x) => {
        return Math.sin((x * Math.PI) / 2);
      };
      const easeInOutSine = (x) => {
        return -(Math.cos(Math.PI * x) - 1) / 2;
      };
      const easeInQuad = (x) => {
        return x * x;
      };
      const easeOutQuad = (x) => {
        return 1 - (1 - x) * (1 - x);
      };
      const easeInOutQuad = (x) => {
        return x < 0.5 ? 2 * x * x : 1 - Math.pow(-2 * x + 2, 2) / 2;
      };
      const easeInCubic = (x) => {
        return x * x * x;
      };
      const easeOutCubic = (x) => {
        return 1 - Math.pow(1 - x, 3);
      };
      const easeInOutCubic = (x) => {
        return x < 0.5 ? 4 * x * x * x : 1 - Math.pow(-2 * x + 2, 3) / 2;
      };
      const easeInQuart = (x) => {
        return x * x * x * x;
      };
      const easeOutQuart = (x) => {
        return 1 - Math.pow(1 - x, 4);
      };
      const easeInOutQuart = (x) => {
        return x < 0.5 ? 8 * x * x * x * x : 1 - Math.pow(-2 * x + 2, 4) / 2;
      };
      const easeInQuint = (x) => {
        return x * x * x * x * x;
      };
      const easeOutQuint = (x) => {
        return 1 - Math.pow(1 - x, 5);
      };
      const easeInOutQuint = (x) => {
        return x < 0.5
          ? 16 * x * x * x * x * x
          : 1 - Math.pow(-2 * x + 2, 5) / 2;
      };
      const easeInExpo = (x) => {
        return x === 0 ? 0 : Math.pow(2, 10 * x - 10);
      };
      const easeOutExpo = (x) => {
        return x === 1 ? 1 : 1 - Math.pow(2, -10 * x);
      };
      const easeInOutExpo = (x) => {
        return x === 0
          ? 0
          : x === 1
          ? 1
          : x < 0.5
          ? Math.pow(2, 20 * x - 10) / 2
          : (2 - Math.pow(2, -20 * x + 10)) / 2;
      };
      const easeInCirc = (x) => {
        return 1 - Math.sqrt(1 - Math.pow(x, 2));
      };
      const easeOutCirc = (x) => {
        return Math.sqrt(1 - Math.pow(x - 1, 2));
      };
      const easeInOutCirc = (x) => {
        return x < 0.5
          ? (1 - Math.sqrt(1 - Math.pow(2 * x, 2))) / 2
          : (Math.sqrt(1 - Math.pow(-2 * x + 2, 2)) + 1) / 2;
      };
      const easeInBack = (x) => {
        const c1 = 1.70158;
        const c3 = c1 + 1;
        return c3 * x * x * x - c1 * x * x;
      };
      const easeOutBack = (x) => {
        const c1 = 1.70158;
        const c3 = c1 + 1;
        return 1 + c3 * Math.pow(x - 1, 3) + c1 * Math.pow(x - 1, 2);
      };
      const easeInOutBack = (x) => {
        const c1 = 1.70158;
        const c2 = c1 * 1.525;
        return x < 0.5
          ? (Math.pow(2 * x, 2) * ((c2 + 1) * 2 * x - c2)) / 2
          : (Math.pow(2 * x - 2, 2) * ((c2 + 1) * (x * 2 - 2) + c2) + 2) / 2;
      };
      const easeInElastic = (x) => {
        const c4 = (2 * Math.PI) / 3;
        return x === 0
          ? 0
          : x === 1
          ? 1
          : -Math.pow(2, 10 * x - 10) * Math.sin((x * 10 - 10.75) * c4);
      };
      const easeOutElastic = (x) => {
        const c4 = (2 * Math.PI) / 3;
        return x === 0
          ? 0
          : x === 1
          ? 1
          : Math.pow(2, -10 * x) * Math.sin((x * 10 - 0.75) * c4) + 1;
      };
      const easeInOutElastic = (x) => {
        const c5 = (2 * Math.PI) / 4.5;
        return x === 0
          ? 0
          : x === 1
          ? 1
          : x < 0.5
          ? -(Math.pow(2, 20 * x - 10) * Math.sin((20 * x - 11.125) * c5)) / 2
          : (Math.pow(2, -20 * x + 10) * Math.sin((20 * x - 11.125) * c5)) / 2 +
            1;
      };
      const easeOutBounce = (x) => {
        const n1 = 7.5625;
        const d1 = 2.75;
        if (x < 1 / d1) {
          return n1 * x * x;
        } else if (x < 2 / d1) {
          return n1 * (x -= 1.5 / d1) * x + 0.75;
        } else if (x < 2.5 / d1) {
          return n1 * (x -= 2.25 / d1) * x + 0.9375;
        } else {
          return n1 * (x -= 2.625 / d1) * x + 0.984375;
        }
      };
      const easeInBounce = (x) => {
        return 1 - easeOutBounce(1 - x);
      };
      const easeInOutBounce = (x) => {
        return x < 0.5
          ? (1 - easeOutBounce(1 - 2 * x)) / 2
          : (1 + easeOutBounce(2 * x - 1)) / 2;
      };
    </script>

    <script>
      //easings.js から読み込んだイージング関数の配列
      const easingFuncs = [
        easeLinear,
        easeInSine,
        easeOutSine,
        easeInOutSine,
        easeInQuad,
        easeOutQuad,
        easeInOutQuad,
        easeInCubic,
        easeOutCubic,
        easeInOutCubic,
        easeInQuart,
        easeOutQuart,
        easeInOutQuart,
        easeInQuint,
        easeOutQuint,
        easeInOutQuint,
        easeInExpo,
        easeOutExpo,
        easeInOutExpo,
        easeInCirc,
        easeOutCirc,
        easeInOutCirc,
        easeInBack,
        easeOutBack,
        easeInOutBack,
        easeInElastic,
        easeOutElastic,
        easeInOutElastic,
        easeOutBounce,
        easeInBounce,
        easeInOutBounce,
      ];
      //イージング関数の名前の配列
      const easingFuncList = easingFuncs.map((f) => {
        return f.name;
      });
      //使用するイージング関数
      let easing = easeInCirc;
      //select 要素を取得
      const selectElem = document.querySelector('select[name="easing"]');
      //イージングを選択するセレクト要素のイベント
      selectElem.addEventListener("change", (e) => {
        //リスナーを登録した select 要素を取得
        const elem = e.currentTarget;
        //選択された値がイージング関数の名前の配列に含まれていれば
        if (easingFuncList.includes(elem.value)) {
          const index = easingFuncList.indexOf(elem.value);
          if (index !== -1) {
            //変数 easing に選択されたイージング関数を代入
            easing = easingFuncs[index];
          }
        }
        console.log("easing:" + easing);
      });
      //アニメーション（スムーススクロール）の持続時間
      const duration = 800;
      //開始時刻を代入する変数（最初は未定義）
      let start;
      //スクロール先の Y 座標（ウィンドウの左上からの座標）
      let targetY;
      //現在の垂直（Y）方向のスクロール量
      let currentY;
      //コールバック関数
      const smoothScroll = (timestamp) => {
        if (start === undefined) {
          start = timestamp;
        }
        //経過時間
        const elapsed = start ? timestamp - start : 0;
        //進捗度を算出してイージングを適用
        const relativeProgress = easing(Math.min(1, elapsed / duration));
        //移動する量（targetY）に進捗度を適用して scrollTo のY座標へ指定する値を算出
        const scrollY = currentY + targetY * relativeProgress;
        //上記で算出した位置へスクロール
        window.scrollTo(0, scrollY);
        //進捗度が1未満の場合は自身を繰り返す
        if (relativeProgress < 1) {
          requestAnimationFrame(smoothScroll);
        }
      };
      //href 属性が # から始まる要素（内部リンク）を全て取得
      const links = document.querySelectorAll('a[href^="#"]');
      //内部リンクが存在すれば
      if (links.length > 0) {
        document.querySelectorAll('a[href^="#"]').forEach((elem) => {
          //それぞれの要素にクリックイベントを設定
          elem.addEventListener("click", (e) => {
            //href 属性の値を取得
            const href = e.currentTarget.getAttribute("href");
            //href 属性の値からスクロール先の要素を取得
            const target =
              href === "#"
                ? //href 属性の値が # の場合は対象を html 要素
                  document.querySelector("html")
                : //それ以外は # 以降の部分を ID として対象の要素
                  document.getElementById(href.replace("#", ""));
            //取得した要素が実際に存在すれば以下を実行
            if (target) {
              //開始時刻を初期化
              start = undefined;
              //対象（スクロール先）の要素の Y 座標
              targetY = target.getBoundingClientRect().y;
              //現在の垂直方向にスクロールされている量
              currentY = window.scrollY;
              //関数を実行
              smoothScroll();
            }
          });
        });
      }
      //ページトップへスクロールするボタンのクリックイベント
      document
        .getElementById("scroll-to-top")
        .addEventListener("click", (e) => {
          //開始時刻を初期化
          start = undefined;
          //スクロール先の要素を html として Y 座標を取得
          targetY = document.querySelector("html").getBoundingClientRect().y;
          //垂直方向にスクロールされている量
          currentY = window.scrollY;
          //関数を実行
          smoothScroll();
        });
    </script>
  </body>
</html>
